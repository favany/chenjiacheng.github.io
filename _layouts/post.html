---
layout: default
---

<div class="main">
    <div class="container post">
        <div class="row">
            <div class="col-md-9 bg-color">
                <h1>{{ page.slug }}</h1>
                <span class="text-muted">{{ page.date | date: "%Y-%m-%d" }}</span>
                {% for category in page.categories %}
                <a href="/archives#{{ category }}" class="badge">{{ category }}</a>
                {% endfor %}
                <hr>
                <div class="post-content">{{ content }}</div>
                <ul class="list-unstyled">
                    <li>
                        <span class="text-muted">上一篇：</span>
                        {% if page.previous.slug %}
                        <a href="{{ page.previous.url }}">{{ page.previous.slug }}</a>
                        {% else %}
                        <span class="text-muted">无</span>
                        {% endif %}

                    </li>
                    <li>
                        <span class="text-muted">下一篇：</span>
                        {% if page.next.slug %}
                        <a href="{{ page.next.url }}">{{ page.next.slug }}</a>
                        {% else %}
                        <span class="text-muted">无</span>
                        {% endif %}

                    </li>
                </ul>
                <div id="gitalk-container"></div>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="post-sidebar"></div>
            </div>
        </div>
    </div>
</div>

<script>
    window.onload = function () {
        var html = '<ul class="nav">';
        $('.post-content h2, .post-content h3').each(function (index, item) {
            $(this).attr('id', index);

            if (item.tagName === 'H2') {
                if (index !== 0) {
                    html += '</ul></li>';
                }
                html += '<li><a href="#' + index + '">' + $(this).text() + '</a><ul class="nav">';
            } else {
                html += '<li><a href="#' + index + '">' + $(this).text() + '</a></li>';
            }
        });
        html += '</ul>';
        $('.post-sidebar').html(html);

        // 锚点定位偏移
        $('.post-sidebar a').click(function () {
            var target = $(this).attr('href');
            $('html, body').animate({
                scrollTop: $(target).offset().top - 70
            }, 500);
            return false;
        });

        var gitalk = new Gitalk({
            clientID: 'f956cf88a0b80b45cbfa',
            clientSecret: '6ae46fc2497ed4a385194e975db2e12380e096c9',
            repo: 'jasonpsr.github.io',
            owner: 'jasonpsr',
            admin: ['Jason'],
            id: location.pathname,
            distractionFreeMode: false,
            createIssueManually: true
        })
        gitalk.render('gitalk-container')
    }
</script>
