---
layout: post
title: 搭建 LAMP 环境的过程详细总结
categories: Linux
---

**安装顺序，建议是apache->mysql->php**

![01.png](/static/images/2016/11/30/01.png)

源码安装的步骤：

1. 解压软件包
2. configure配置
3. make编译
4. make install安装

## 一、安装apche

### 1. 解压软件

软件解压格式：

```
后缀tar.gz 语法：tar –zxvf 压缩包
后缀tar.bz2 语法：tar –jxvf 压缩包
```

tar命令解压缩语法：

* -x 解包.tar文件
* -v 显示详细信息
* -f 指定解压文件
* -z 解压缩
 
![02.png](/static/images/2016/11/30/02.png)

### 2. 进入解压后的目录

![03.png](/static/images/2016/11/30/03.png)

### 3. 执行配置

可以使用./configure –help查看配置的帮助。

```
./configure --prefix=/usr/local/apache \
--enable-modules=all \
--enable-rewrite \
--enable-mods-shared=all \
--enable-so
```

这里apache的安装目录为：/usr/local/apache

![04.png](/static/images/2016/11/30/04.png)

### 4. 执行编译

![05.png](/static/images/2016/11/30/05.png)

### 5. 执行安装

![06.png](/static/images/2016/11/30/06.png)

### 6. 安装完成后，要启动apache的服务

开启服务语法：

```
/usr/local/apache/bin/apachectl start|stop|restart
```

![07.png](/static/images/2016/11/30/07.png)

查看是否启动成功：

```
netstat –tunpl |grep 80
```

![08.png](/static/images/2016/11/30/08.png)

apache启动成功后，进行测试：

![09.png](/static/images/2016/11/30/09.png)

## 二、安装mysql

### 1. 新建一个mysql的组

![10.png](/static/images/2016/11/30/10.png)

### 2. 新建一个mysql用户，加入到mysql组里面来

![11.png](/static/images/2016/11/30/11.png)

### 3. 解压软件

![12.png](/static/images/2016/11/30/12.png)

### 4. 进入解压后的目录

![13.png](/static/images/2016/11/30/13.png)

### 5. 配置mysql编译选项，指定安装路径及支持的字符集

```
./configure --prefix=/usr/local/mysql \
--with-charset=utf8 \
--with-extra-charsets=gbk,gb2312,binary
```

这里mysql的安装目录为：/usr/local/mysql

![14.png](/static/images/2016/11/30/14.png)

### 6. 执行编译 && 执行安装

两个步骤一起执行，过程会比较漫长

![15.png](/static/images/2016/11/30/15.png)

### 7. 复制mysql的配置文件

注意：是从解压的目录里面复制到/etc/my.cnf

![16.png](/static/images/2016/11/30/16.png)

### 8. 初始化数据库

```
./bin/mysql_install_db --user=mysql \
--datadir=/usr/local/mysql/data
```

![17.png](/static/images/2016/11/30/17.png)

### 9. 安全性配置

为了安全，把所有文件修改为root用户所有，把data目录修改为mysql用户所有

![18.png](/static/images/2016/11/30/18.png)

### 10. 启动mysql服务

注意：&表示该服务在后台执行。

![19.png](/static/images/2016/11/30/19.png)

查看是否启动：

![20.png](/static/images/2016/11/30/20.png)

### 11. 登录mysql服务器

注意：在安装完成后，默认mysql是没有root用户密码的。

![21.png](/static/images/2016/11/30/21.png)

为了安全要更改mysql里面root用户的密码。

![22.png](/static/images/2016/11/30/22.png)

清空权限缓存，使更改立即生效。

![23.png](/static/images/2016/11/30/23.png)

重新登录

![24.png](/static/images/2016/11/30/24.png)

关闭服务的一个命令：

```
pkill 服务名称
```

比如要关闭apache则使用pkill httpd, 比如要关闭mysql则使用 pkill mysqld,

注意：在默认情况下，操作源码包安装的软件，不要使用service来操作。

## 三、安装php

### 1. 解压

![25.png](/static/images/2016/11/30/25.png)

### 2. 进入解压后的目录

![26.png](/static/images/2016/11/30/26.png)

### 3. 配置

```
./configure --prefix=/usr/local/php \
--with-apxs2=/usr/local/apache/bin/apxs \
--with-mysql=/usr/local/mysql
```

这里php的安装目录为：/usr/local/php

![27.png](/static/images/2016/11/30/27.png)

### 4. 执行编译 && 执行安装

![28.png](/static/images/2016/11/30/28.png)

### 5. 复制php的配置文件

注意：进入到php解压的目录

![29.png](/static/images/2016/11/30/29.png)

### 6. 配置让apache支持php

打开apache的配置文件：

![30.png](/static/images/2016/11/30/30.png)

添加如下代码：

![31.png](/static/images/2016/11/30/31.png)

重启apache：

![32.png](/static/images/2016/11/30/32.png)

测试是否生效：

![33.png](/static/images/2016/11/30/33.png)


![34.png](/static/images/2016/11/30/34.png)
 
![35.png](/static/images/2016/11/30/35.png)

### 7. 测试是否和mysql连接成功。

![36.png](/static/images/2016/11/30/36.png)

![37.png](/static/images/2016/11/30/37.png)

## 四、新建一个虚拟主机测试

### 1. 开启访问权限

![38.png](/static/images/2016/11/30/38.png)

![39.png](/static/images/2016/11/30/39.png)

![40.png](/static/images/2016/11/30/40.png)

### 2. 打开 apache的配置文件，修改默认首页面

![41.png](/static/images/2016/11/30/41.png)

![42.png](/static/images/2016/11/30/42.png)

![43.png](/static/images/2016/11/30/43.png)

![44.png](/static/images/2016/11/30/44.png)

![45.png](/static/images/2016/11/30/45.png)

### 3. 重启apache服务器

![46.png](/static/images/2016/11/30/46.png)

### 4. 配置本地host文件

![47.png](/static/images/2016/11/30/47.png)

### 5. 测试成功

![48.png](/static/images/2016/11/30/48.png)

## 五、把apache和mysql配置为开机启动

打开/etc/rc.local，linux系统每次启动后都会自动执行这个文件，在该文件中，加入以下两行内容：

```
/usr/local/apache/bin/apachectl start
/usr/local/mysql/bin/mysqld_safe --user=mysql &
```

如何卸载源码包安装的软件：停止服务，删除掉整个安装目录即可。

比如卸载apace则删除/usr/local/apache目录，比如卸载mysql则删除/usr/local/mysql目录。